# ğŸ”§ ××¤×ª ×§×‘×¦×™ ××¢×¨×›×ª ×”××‘×—×•×Ÿ - Intelligent Repair

## ğŸ“Š ×ª×¨×©×™× ×–×¨×™××” ×›×œ×œ×™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              USER INPUT                                      â”‚
â”‚                    (×˜×§×¡×˜ + ×ª××•× ×” ××•×¤×¦×™×•× ×œ×™×ª)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“± FRONTEND (app/user/consult/questions/)                                   â”‚
â”‚  â”œâ”€â”€ page.tsx â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ×¢××•×“ ×”×¦'××˜ ×”×¨××©×™                          â”‚
â”‚  â”œâ”€â”€ hooks/useHybridFlow.ts â”€â”€â”€â”€â”€ × ×™×”×•×œ state + ×§×¨×™××•×ª API                  â”‚
â”‚  â””â”€â”€ components/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ×¨×›×™×‘×™ UI                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                          POST /api/ai/questions
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš¦ BACKEND ROUTER (app/api/ai/questions/route.ts)                          â”‚
â”‚  â”œâ”€â”€ STEP -1: Safety Check â†â”€â”€â”€â”€â”€ lib/knowledge/safety-rules.ts             â”‚
â”‚  â”œâ”€â”€ STEP 0: Symptom Detection â†â”€ lib/knowledge/car-symptoms.json           â”‚
â”‚  â”œâ”€â”€ STEP 1: KB Flow â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ lib/knowledge/warning-lights.json         â”‚
â”‚  â”œâ”€â”€ STEP 3: Scenario Runner â†â”€â”€â”€ lib/knowledge/scenarios.ts                â”‚
â”‚  â””â”€â”€ STEP 4: AI Fallback â†â”€â”€â”€â”€â”€â”€â”€ lib/ai/prompt-builder.ts                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ§  AI LAYER (lib/ai/)                                                       â”‚
â”‚  â”œâ”€â”€ context-analyzer.ts â”€â”€â”€â”€â”€â”€â”€â”€ × ×™×ª×•×— ×§×œ×˜ ×•×–×™×”×•×™ ×¡×•×’ ×”×ª×§×œ×”                â”‚
â”‚  â”œâ”€â”€ prompt-builder.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ×‘× ×™×™×ª ×¤×¨×•××¤×˜ ×œ-AI                         â”‚
â”‚  â””â”€â”€ client.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ OpenAI API Client                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ lib/knowledge/ - ×××’×¨×™ ×”×™×“×¢ (Knowledge Base)

### ğŸ“„ warning-lights.json
**×ª×¤×§×™×“:** ×××’×¨ × ×•×¨×•×ª ××–×”×¨×” ××œ× ×¢× ×ª×¨×—×™×©×™×, ×¡×™×‘×•×ª, ×•×©××œ×•×ª ××¤×ª×—

**××‘× ×”:**
```json
{
  "check_engine_light": {
    "names": { "he": ["× ×•×¨×ª ×‘×“×•×§ ×× ×•×¢"], "en": ["Check Engine"] },
    "first_question": { "text": "...", "options": [...] },
    "scenarios": {
      "steady_normal": { "causes": [...], "severity": "low" },
      "flashing": { "causes": [...], "severity": "critical" }
    }
  }
}
```

**××§×•×©×¨ ×œ:**
- `route.ts` - ×§×¨×™××ª × ×ª×•× ×™ × ×•×¨×•×ª ×•×ª×¨×—×™×©×™×
- `prompt-builder.ts` - ×”×¢×‘×¨×ª KB context ×œ-AI
- `context-analyzer.ts` - ×–×™×”×•×™ × ×•×¨×•×ª ××˜×§×¡×˜

---

### ğŸ“„ car-symptoms.json
**×ª×¤×§×™×“:** ××™×¤×•×™ ×¡×™××¤×˜×•××™× (×¨×¢×©×™×, ×¨×™×—×•×ª, ×ª×—×•×©×•×ª) ×œ×ª×¨×—×™×©×™×/× ×•×¨×•×ª

**××‘× ×”:**
```json
{
  "symptoms": [
    {
      "category": "noises",
      "mappings": [
        { "keywords": ["×ª×™×§×ª×•×§", "×§×œ×™×§×™×"], "targetId": "car_wont_start", "type": "scenario" }
      ]
    }
  ]
}
```

**××§×•×©×¨ ×œ:**
- `route.ts` â†’ ×¤×•× ×§×¦×™×™×ª `detectSymptomFromText()` - ×–×™×”×•×™ ×¡×™××¤×˜×•××™× ××˜×§×¡×˜ ×—×•×¤×©×™

---

### ğŸ“„ scenarios.ts
**×ª×¤×§×™×“:** ×ª×¨×—×™×©×™× ×¡×˜×˜×™×™× (×”×¨×›×‘ ×œ× ×× ×™×¢, ×”×ª×—×××•×ª, ×¤× ×¦'×¨)

**××‘× ×”:**
```typescript
export const SCENARIOS = {
  car_wont_start: {
    id: 'car_wont_start',
    title: '×”×¨×›×‘ ×œ× ×× ×™×¢',
    startingStepId: 'check_noise',
    suspects: [{ id: 'battery', name: '××¦×‘×¨' }],
    steps: { check_noise: { text: "...", options: [...] } }
  }
}
```

**××§×•×©×¨ ×œ:**
- `route.ts` - ×”×¨×¦×ª ×ª×¨×—×™×©×™× ×¦×¢×“ ××—×¨ ×¦×¢×“
- `context-analyzer.ts` - ×–×™×”×•×™ ×ª×¨×—×™×© ××˜×§×¡×˜

---

### ğŸ“„ safety-rules.ts
**×ª×¤×§×™×“:** ×—×•×§×™ ×‘×˜×™×—×•×ª ×§×¨×™×˜×™×™× ×©×¢×•×¦×¨×™× ××ª ×”×ª×”×œ×™×š

**××‘× ×”:**
```typescript
export const SAFETY_RULES = [
  {
    id: 'brakes_fail',
    keywords: ['××™×Ÿ ×‘×œ××™×', '×”×‘×œ××™× ×œ× ×¢×•×‘×“×™×'],
    message: '×¢×¦×•×¨ ××™×“!',
    level: 'CRITICAL',
    endConversation: true
  }
]
```

**××§×•×©×¨ ×œ:**
- `context-analyzer.ts` â†’ ×¤×•× ×§×¦×™×™×ª `analyzeUserContext()` - ×¡×¨×™×§×ª ×‘×˜×™×—×•×ª ×¨××©×•× ×”

---

### ğŸ“„ keywords.json
**×ª×¤×§×™×“:** ××™×œ×•×ª ××¤×ª×— ×œ×–×™×”×•×™ ×¨××ª ×¡×›× ×” (danger/caution)

**××‘× ×”:**
```json
{
  "danger": ["× ×•×¨×ª ×©××Ÿ ××“×•××”", "×œ×—×¥ ×©××Ÿ"],
  "caution": ["×¦'×§ ×× ×’'×™×Ÿ", "× ×•×¨×ª ×× ×•×¢"]
}
```

**××§×•×©×¨ ×œ:**
- `context-analyzer.ts` - ×§×‘×™×¢×ª severity ×©×œ × ×•×¨×”

---

## ğŸ“ lib/ai/ - ×©×›×‘×ª ×”×‘×™× ×” ×”××œ××›×•×ª×™×ª

### ğŸ“„ context-analyzer.ts
**×ª×¤×§×™×“:** × ×™×ª×•×— ×§×œ×˜ ×¨××©×•× ×™ ×•×§×‘×™×¢×ª ×¡×•×’ ×”×ª×§×œ×”

**×¤×•× ×§×¦×™×•×ª ×¢×™×§×¨×™×•×ª:**
```typescript
analyzeUserContext(text) â†’ 
  | { type: 'SAFETY_STOP', rule }      // ×¡×›× ×” - ×¢×¦×™×¨×” ××™×™×“×™×ª
  | { type: 'WARNING_LIGHT', lightId } // × ×•×¨×” ××–×•×”×”
  | { type: 'START_SCENARIO', id }     // ×ª×¨×—×™×© ××–×•×”×”
  | { type: 'CONSULT_AI' }             // ×œ× ××–×•×”×” - AI
```

**××§×•×©×¨ ×œ:**
- `route.ts` - × ×§×¨× ×‘-STEP -1 ×•-STEP 0
- `safety-rules.ts` - ×§×¨×™××ª ×—×•×§×™ ×‘×˜×™×—×•×ª
- `warning-lights.json` - ×–×™×”×•×™ × ×•×¨×•×ª
- `keywords.json` - ×§×‘×™×¢×ª severity

---

### ğŸ“„ prompt-builder.ts
**×ª×¤×§×™×“:** ×‘× ×™×™×ª ×¤×¨×•××¤×˜×™× ×œ-AI

**×¤×•× ×§×¦×™×•×ª ×¢×™×§×¨×™×•×ª:**
```typescript
buildChatPrompt()          // ××¦×‘ KB - AI ×›××ª×¨×’× ×‘×œ×‘×“
buildGeneralExpertPrompt() // ××¦×‘ ××•××—×” - ×›×©××™×Ÿ KB
```

**××§×•×©×¨ ×œ:**
- `route.ts` â†’ `callExpertAI()` - ×©×œ×™×—×ª ×¤×¨×•××¤×˜
- `warning-lights.json` - ×”×¢×‘×¨×ª KB context ×œ-AI

---

### ğŸ“„ client.ts
**×ª×¤×§×™×“:** Wrapper ×œ-OpenAI API

**××§×•×©×¨ ×œ:**
- `route.ts` â†’ `callExpertAI()` - ×§×¨×™××•×ª ×œ-OpenAI

---

### ğŸ“„ types.ts
**×ª×¤×§×™×“:** ×˜×™×¤×•×¡×™ TypeScript ×œ×ª×’×•×‘×•×ª AI

```typescript
interface UserAnswer {
  question: string;
  answer: string;
}
```

---

### ğŸ“„ image-utils.ts
**×ª×¤×§×™×“:** ×”××¨×ª ×ª××•× ×•×ª ×œ×¤×•×¨××˜ base64

**××§×•×©×¨ ×œ:**
- `route.ts` - ×©×œ×™×—×ª ×ª××•× ×•×ª ×œ-AI

---

### ğŸ“„ sanitize.ts
**×ª×¤×§×™×“:** × ×™×§×•×™ ×§×œ×˜ ××©×ª××©

---

### ğŸ“„ retry.ts
**×ª×¤×§×™×“:** × ×™×¡×™×•× ×•×ª ×—×•×–×¨×™× ×œ×§×¨×™××•×ª API

---

## ğŸ“ lib/types/

### ğŸ“„ knowledge.ts
**×ª×¤×§×™×“:** ×˜×™×¤×•×¡×™ TypeScript ×œ-KB

```typescript
interface DiagnosticState {
  currentScenarioId: string | null;
  detectedLightType?: string;
  causeScores?: Record<string, number>;
  askedQuestionIds?: string[];
}

interface Scenario { ... }
interface SafetyRule { ... }
```

---

## ğŸ“ app/api/ai/ - Backend API Routes

### ğŸ“„ questions/route.ts â­ (×”×§×•×‘×¥ ×”××¨×›×–×™!)
**×ª×¤×§×™×“:** Router ×¨××©×™ - ××—×‘×¨ ××ª ×›×œ ×”×—×œ×§×™×

**×–×¨×™××”:**
```
POST /api/ai/questions
â”‚
â”œâ”€â”€ STEP -1: Safety Check (safety-rules.ts)
â”‚   â””â”€â”€ ×× ×¡×›× ×” â†’ return safety_alert
â”‚
â”œâ”€â”€ STEP 0: Symptom Detection (car-symptoms.json)
â”‚   â””â”€â”€ ×× ×¡×™××¤×˜×•× â†’ route ×œ×ª×¨×—×™×©/× ×•×¨×”
â”‚
â”œâ”€â”€ STEP 1: KB Flow (warning-lights.json)
â”‚   â”œâ”€â”€ determineScenario() - ×§×‘×™×¢×ª ×ª×¨×—×™×©
â”‚   â”œâ”€â”€ updateScores() - ×¢×“×›×•×Ÿ × ×™×§×•×“ ×¡×™×‘×•×ª
â”‚   â”œâ”€â”€ getNextQuestion() - ×©××œ×” ×”×‘××” ××”-KB
â”‚   â””â”€â”€ generateDiagnosis() - ×™×¦×™×¨×ª ××‘×—×•×Ÿ
â”‚
â”œâ”€â”€ STEP 3: Scenario Runner (scenarios.ts)
â”‚   â””â”€â”€ ×”×¨×¦×ª ×ª×¨×—×™×©×™× ×¡×˜×˜×™×™×
â”‚
â””â”€â”€ STEP 4: AI Fallback (prompt-builder.ts)
    â””â”€â”€ callExpertAI() - ×©×œ×™×—×” ×œ-OpenAI
```

**×¤×•× ×§×¦×™×•×ª ××¤×ª×—:**
| ×¤×•× ×§×¦×™×” | ×ª×¤×§×™×“ |
|---------|--------|
| `detectSymptomFromText()` | ×¡×¨×™×§×ª car-symptoms.json |
| `determineScenario()` | ×§×‘×™×¢×ª ×ª×¨×—×™×© ××ª×©×•×‘×•×ª |
| `updateScores()` | ×¢×“×›×•×Ÿ × ×™×§×•×“ ×¡×™×‘×•×ª |
| `shouldDiagnose()` | ×‘×“×™×§×ª ×¡×£ ××‘×—×•×Ÿ |
| `getNextQuestion()` | ×©×œ×™×¤×ª ×©××œ×” ××”-KB |
| `generateDiagnosis()` | ×™×¦×™×¨×ª ××‘×—×•×Ÿ ×¡×•×¤×™ |
| `callExpertAI()` | ×§×¨×™××” ×œ-AI ××•××—×” |

---

### ğŸ“„ aiUtils.ts
**×ª×¤×§×™×“:** ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ×œ× ×™×ª×•×— ×ª×’×•×‘×•×ª AI

```typescript
extractJSON(text) // ×—×™×œ×•×¥ JSON ××ª×’×•×‘×ª AI
```

---

## ğŸ“ app/user/consult/questions/ - Frontend

### ğŸ“„ page.tsx
**×ª×¤×§×™×“:** ×¢××•×“ ×”×¦'××˜ ×”×¨××©×™ - ×¨×™× ×“×•×¨ ×¨×›×™×‘×™×

**××§×•×©×¨ ×œ:**
- `useHybridFlow.ts` - ×§×‘×œ×ª state
- ×›×œ ×”-components

---

### ğŸ“„ hooks/useHybridFlow.ts â­
**×ª×¤×§×™×“:** × ×™×”×•×œ state, ×©×œ×™×—×ª ×”×•×“×¢×•×ª, ×¢×“×›×•×Ÿ context

**State ×× ×•×”×œ:**
```typescript
interface FlowState {
  status: "IDLE" | "PROCESSING" | "WAITING_USER" | "FINISHED";
  messages: Message[];
  context: DiagnosticState;
  currentOptions: string[];
}
```

**×¤×•× ×§×¦×™×•×ª ××¤×ª×—:**
| ×¤×•× ×§×¦×™×” | ×ª×¤×§×™×“ |
|---------|--------|
| `sendMessage()` | ×©×œ×™×—×ª ×”×•×“×¢×” ×œ-API |
| `addMessage()` | ×”×•×¡×¤×ª ×”×•×“×¢×” ×œ×¦'××˜ |

**××§×•×©×¨ ×œ:**
- `route.ts` - ×§×¨×™××•×ª POST /api/ai/questions
- ×›×œ ×”-components - ×”×¢×‘×¨×ª state ×•-callbacks

---

### ğŸ“„ hooks/useAIStateMachine.ts
**×ª×¤×§×™×“:** State machine ×™×©×Ÿ (×œ× ×‘×©×™××•×© ×¢×™×§×¨×™)

---

## ğŸ“ components/ - ×¨×›×™×‘×™ UI

### ğŸ“„ FinalDiagnosisCard.tsx â­
**×ª×¤×§×™×“:** ×›×¨×˜×™×¡ ××‘×—×•×Ÿ ×¡×•×¤×™ ×¢× ×›×¤×ª×•×¨×™ ×’×¨×¨/××•×¡×š

**Props × ×“×¨×©×™×:**
```typescript
{
  title: string;
  results: { issue, probability, explanation }[];
  mechanicReport: { topSuspect, severity, towConditions };
  showTowButton: boolean;
}
```

---

### ğŸ“„ ChatBubble.tsx
**×ª×¤×§×™×“:** ×‘×•×¢×•×ª ×”×•×“×¢×” (××©×ª××©/AI/××¢×¨×›×ª)

---

### ğŸ“„ MultiChoiceButtons.tsx
**×ª×¤×§×™×“:** ×›×¤×ª×•×¨×™ ×‘×—×™×¨×” ××¨×•×‘×”

---

### ğŸ“„ YesNoButtons.tsx
**×ª×¤×§×™×“:** ×›×¤×ª×•×¨×™ ×›×Ÿ/×œ×

---

### ğŸ“„ InstructionBubble.tsx
**×ª×¤×§×™×“:** ×”×•×¨××•×ª ×‘×™×¦×•×¢ (inspect/fill)

---

### ğŸ“„ WarningBanner.tsx
**×ª×¤×§×™×“:** ×‘×× ×¨ ××–×”×¨×” (safety alerts)

---

### ğŸ“„ FreeTextInput.tsx
**×ª×¤×§×™×“:** ×©×“×” ×§×œ×˜ ×˜×§×¡×˜ ×—×•×¤×©×™

---

### ğŸ“„ TypingBubble.tsx / TypingIndicator.tsx
**×ª×¤×§×™×“:** ×× ×™××¦×™×™×ª "××§×œ×™×“..."

---

## ğŸ”— ××¤×ª ×§×™×©×•×¨×™× ×‘×™×Ÿ ×§×‘×¦×™×

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        route.ts (××¨×›×–)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                    â”‚
         â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ context-        â”‚  â”‚ prompt-         â”‚  â”‚ warning-        â”‚
â”‚ analyzer.ts     â”‚  â”‚ builder.ts      â”‚  â”‚ lights.json     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                    â”‚
         â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ safety-rules.ts â”‚  â”‚ client.ts       â”‚  â”‚ scenarios.ts    â”‚
â”‚ keywords.json   â”‚  â”‚ (OpenAI)        â”‚  â”‚ car-symptoms    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ ×¡×“×¨ ×¢×“×™×¤×•×™×•×ª ×‘×¢×™×‘×•×“

| ×¡×“×¨ | ×©×›×‘×” | ×§×•×‘×¥ | ×ª× ××™ |
|-----|------|------|------|
| 1 | Safety | safety-rules.ts | ××™×œ×•×ª ×¡×›× ×” |
| 2 | Symptoms | car-symptoms.json | ××™×¤×•×™ ×¡×™××¤×˜×•××™× |
| 3 | KB Light | warning-lights.json | × ×•×¨×” ××–×•×”×” |
| 4 | Scenario | scenarios.ts | ×ª×¨×—×™×© ××–×•×”×” |
| 5 | AI | prompt-builder.ts | Fallback |

---

*×¢×•×“×›×Ÿ: ${new Date().toLocaleDateString('he-IL')}*




